# ğŸ¤– ××¢×¨×›×ª × ×™×”×•×œ ××—×™×¨×™× ××•×˜×•××˜×™×ª - Gogobe

## ğŸ¯ ×¡×§×™×¨×” ×›×œ×œ×™×ª

××¢×¨×›×ª ××ª×§×“××ª ×œ× ×™×”×•×œ ××—×™×¨×™× ××•×˜×•××˜×™ ×××§×•×¨×•×ª ××¨×•×‘×™×, ×¢× ×ª××™×›×” ×‘×©×¤×•×ª ×¨×‘×•×ª ×•×¢×™×‘×•×“ ××§×‘×™×œ×™.

---

## ğŸš€ ×ª×›×•× ×•×ª ×¢×™×§×¨×™×•×ª

### âœ… ××•×˜×•××¦×™×” ××œ××”
- **×”×•×¨×“×” ××•×˜×•××˜×™×ª** ××›×œ ×”××§×•×¨×•×ª
- **×¢×™×‘×•×“ ××§×‘×™×œ×™** ×©×œ ×§×‘×¦×™×
- **×¡×™×•×•×’ ××•×˜×•××˜×™** ×œ×××•×ª ××œ×¤×™ ××•×¦×¨×™×
- **×ª×–××•×Ÿ ×—×›×** - ×¨×¥ ×‘×¨×§×¢ ×œ×œ× ×”×ª×¢×¨×‘×•×ª

### ğŸŒ ×ª××™×›×” ×¨×‘-×œ×©×•× ×™×ª
- **×¢×‘×¨×™×ª** (he)
- **×× ×’×œ×™×ª** (en)
- **×¢×¨×‘×™×ª** (ar)
- **×¨×•×¡×™×ª** (ru)
- ×§×œ ×œ×”×•×¡×™×£ ×©×¤×•×ª × ×•×¡×¤×•×ª!

### âš¡ ×¢×™×‘×•×“ ××§×‘×™×œ×™
- **Multi-Processing** - ×× ×¦×œ ××ª ×›×œ ×œ×™×‘×•×ª ×”××¢×‘×“
- **Multi-Threading** - ×”×•×¨×“×•×ª ×‘××§×‘×™×œ
- **Batch Processing** - ×¢×™×‘×•×“ ××¦×•×•×” ×—×›×
- **××”×™×¨×•×ª**: ××œ×¤×™ ××•×¦×¨×™× ×œ×©× ×™×™×”!

### ğŸ“Š × ×™×”×•×œ ××§×•×¨×•×ª ××¨×•×‘×™×
- **××•×“×•×œ×¨×™** - ×›×œ ××§×•×¨ ×¢×¦×××™
- **×”×¨×—×‘×” ×§×œ×”** - ×”×•×¡×£ ××§×•×¨×•×ª ×—×“×©×™× ×‘×§×œ×•×ª
- **×ª×–××•×Ÿ ×’××™×©** - ×œ×›×œ ××§×•×¨ ×ª×–××•×Ÿ ××©×œ×•
- **××¢×§×‘ ×•×“×™×•×•×—** - ×œ×•×’×™× ××¤×•×¨×˜×™×

---

## ğŸ“‚ ××¨×›×™×˜×§×˜×•×¨×”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ğŸ¤– Auto Price Manager                      â”‚
â”‚               (×”×× ×¦×— - ××ª×–××Ÿ ×”×›×œ)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚             â”‚             â”‚
â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
â”‚ KingStoreâ”‚ â”‚Shufersal â”‚ â”‚  Rami    â”‚
â”‚  Source  â”‚ â”‚  Source  â”‚ â”‚  Levi    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚            â”‚            â”‚
     â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
     â”‚   â”‚                 â”‚   â”‚
     â–¼   â–¼                 â–¼   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ğŸ“¥ Smart Downloader        â”‚
â”‚   (×”×•×¨×“×” ××§×‘×™×œ×™×ª + ×—×›××”)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ğŸ”„ Parallel Processor       â”‚
â”‚  (×¢×™×‘×•×“ XML/JSON/CSV ××§×‘×™×œ×™)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ·ï¸ Multilang Classifier        â”‚
â”‚  (×¡×™×•×•×’ ×¨×‘-×œ×©×•× ×™ ××§×‘×™×œ×™)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ğŸ’¾ PostgreSQL Database      â”‚
â”‚    (×× ×•×¨××œ ×•××•×¤×˜×™××œ×™)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› ï¸ ×¨×›×™×‘×™×

### 1ï¸âƒ£ Auto Price Manager (`auto_price_manager.py`)
**×”×× ×¦×— ×©×œ ×”××¢×¨×›×ª** - ××ª×–××Ÿ ×•×× ×”×œ ××ª ×›×œ ×”×ª×”×œ×™×š

**×ª×¤×§×™×“×™×:**
- ×§×¨×™××” ×œ×›×œ ×”××§×•×¨×•×ª ×œ×¤×™ ×ª×–××•×Ÿ
- ××¢×§×‘ ××—×¨ ×¡×˜×˜×•×¡
- ×“×™×•×•×— ×•×˜×™×¤×•×œ ×‘×©×’×™××•×ª
- ×™×¦×™×¨×ª Scraping Sessions

**×©×™××•×©:**
```bash
# ×”×¨×¦×” ×—×“-×¤×¢××™×ª
python backend\scripts\auto_price_manager.py --once

# ×ª×–××•×Ÿ ××•×˜×•××˜×™ (×¨×¥ ×‘×¨×§×¢)
python backend\scripts\auto_price_manager.py

# ××§×•×¨ ×¡×¤×¦×™×¤×™
python backend\scripts\auto_price_manager.py --once --source kingstore
```

### 2ï¸âƒ£ Parallel Multilang Classifier (`parallel_multilang_classifier.py`)
**××¡×•×•×’ ×—×›× ×¨×‘-×œ×©×•× ×™ ××§×‘×™×œ×™**

**×ª×›×•× ×•×ª:**
- âœ… ×ª××™×›×” ×‘-4 ×©×¤×•×ª (×¢×‘×¨×™×ª, ×× ×’×œ×™×ª, ×¢×¨×‘×™×ª, ×¨×•×¡×™×ª)
- âœ… 17 ×§×˜×’×•×¨×™×•×ª ××•×›× ×•×ª
- âœ… ×¢×™×‘×•×“ ××§×‘×™×œ×™ - ×× ×¦×œ ××ª ×›×œ ×”××¢×‘×“
- âœ… ×”×ª×××” ×œ××•×ª×’×™× ×•××™×œ×•×ª ××¤×ª×—
- âœ… ×¦×™×•×Ÿ ×××•×Ÿ (Confidence Score)

**×“×•×’××”:**
```bash
# ×‘×“×™×§×ª ×¡×™×•×•×’ ×œ××•×¦×¨
python backend\scripts\parallel_multilang_classifier.py --test "×—×œ×‘ ×ª× ×•×‘×”"

# ×¡×™×•×•×’ ×›×œ ×”××•×¦×¨×™× (4 workers)
python backend\scripts\parallel_multilang_classifier.py --workers 4

# ×¡×™×•×•×’ ×œ-vertical ×¡×¤×¦×™×¤×™
python backend\scripts\parallel_multilang_classifier.py --vertical supermarket
```

**×‘×™×¦×•×¢×™×:**
```
××•×¦×¨×™×:     13,522
×–××Ÿ:         ~120 ×©× ×™×•×ª
××”×™×¨×•×ª:      ~110 ××•×¦×¨×™×/×©× ×™×™×”
Workers:     4 (××§×‘×™×œ×™)
×”×¦×œ×—×”:       58%
```

### 3ï¸âƒ£ Smart Downloaders
**××•×¨×™×“×™× ×—×›××™× ×¢× ×ª××™×›×” ×‘××§×‘×™×œ×™×•×ª**

**×ª×›×•× ×•×ª:**
- âœ… ×”×•×¨×“×•×ª ××§×‘×™×œ×•×ª (Thread Pool)
- âœ… ×–×™×”×•×™ ×›×¤×™×œ×•×™×•×ª (Hash)
- âœ… ×—×™×“×•×© ××•×˜×•××˜×™
- âœ… Retry logic
- âœ… Progress tracking

**×“×•×’××”:**
```bash
# ×”×•×¨×“×” ××§×‘×™×œ×™×ª ×©×œ 50 ×§×‘×¦×™×
python backend\scripts\kingstore_smart_downloader.py --limit 50 --parallel 10
```

### 4ï¸âƒ£ Parallel Processors
**××¢×‘×“×™× ××§×‘×™×œ×™× ×œ×§×‘×¦×™×**

**×ª×›×•× ×•×ª:**
- âœ… ×¢×™×‘×•×“ XML/JSON/CSV
- âœ… Batch processing
- âœ… Transaction safety
- âœ… Error handling per item
- âœ… SAVEPOINT support

---

## ğŸ“‹ ×”×•×¡×¤×ª ××§×•×¨ ×—×“×©

### ×©×œ×‘ 1: ×™×¦×™×¨×ª Downloader
```python
# backend/scripts/shufersal_downloader.py
def download_from_shufersal():
    # Logic ×œ×”×•×¨×“×” ×-Shufersal
    pass
```

### ×©×œ×‘ 2: ×™×¦×™×¨×ª Processor
```python
# backend/scripts/shufersal_processor.py
def process_shufersal_xml(filename):
    # Logic ×œ×¢×™×‘×•×“ XML ×©×œ Shufersal
    pass
```

### ×©×œ×‘ 3: ×”×’×“×¨×” ×‘-Auto Manager
```python
# In auto_price_manager.py
SOURCES_CONFIG = {
    'shufersal': {
        'name': 'Shufersal',
        'downloader_script': 'backend/scripts/shufersal_downloader.py',
        'processor_script': 'backend/scripts/shufersal_processor.py',
        'classifier_script': 'backend/scripts/parallel_multilang_classifier.py',
        'vertical': 'supermarket',
        'schedule': '0 */8 * * *',  # ×›×œ 8 ×©×¢×•×ª
        'parallel_downloads': 10,
        'parallel_processing': 4,
        'enabled': True
    }
}
```

**×–×”×•! ×”××¢×¨×›×ª ×ª×ª×—×™×œ ×œ×¢×‘×“ ××ª ×”××§×•×¨ ×”×—×“×© ××•×˜×•××˜×™×ª!** ğŸ‰

---

## ğŸ·ï¸ ×”×•×¡×¤×ª ×©×¤×” ×—×“×©×” ×œ××¡×•×•×’

### ×“×•×’××”: ×”×•×¡×¤×ª ×¦×¨×¤×ª×™×ª

```python
# In parallel_multilang_classifier.py
CATEGORY_KEYWORDS_MULTILANG = {
    'Dairy': {
        'he': ['×—×œ×‘', '×’×‘×™× ×”', ...],
        'en': ['milk', 'cheese', ...],
        'ar': ['Ø­Ù„ÙŠØ¨', 'Ø¬Ø¨Ù†', ...],
        'ru': ['Ğ¼Ğ¾Ğ»Ğ¾ĞºĞ¾', 'ÑÑ‹Ñ€', ...],
        'fr': ['lait', 'fromage', 'yaourt', 'beurre'],  # â­ ×”×•×¡×¤×”!
    },
    # ... rest of categories
}
```

**×”××¡×•×•×’ ××•×˜×•××˜×™×ª ×™×ª××•×š ×‘×©×¤×” ×”×—×“×©×”!**

---

## âš¡ ××•×¤×˜×™××™×–×¦×™×•×ª

### 1. **Database Indexing**
```sql
-- ××™× ×“×§×¡×™× ×—×™×•× ×™×™× ×œ××”×™×¨×•×ª
CREATE INDEX idx_products_category ON products(category_id);
CREATE INDEX idx_products_vertical ON products(vertical_id);
CREATE INDEX idx_prices_store ON prices(store_id);
CREATE INDEX idx_prices_product ON prices(product_id);
CREATE INDEX idx_products_name ON products USING GIN (name gin_trgm_ops);
```

### 2. **Batch Processing**
```python
CHUNK_SIZE = 1000  # Process 1000 products at a time
# ×–×” ×××–×Ÿ ×‘×™×Ÿ ×–×™×›×¨×•×Ÿ ×œ××”×™×¨×•×ª
```

### 3. **Connection Pooling**
```python
# ×›×œ worker ××§×‘×œ connection ××©×œ×•
# ×œ× ×©×™×ª×•×£ connections ×‘×™×Ÿ processes
```

### 4. **Parallel Workers**
```python
MAX_WORKERS = min(cpu_count(), 8)
# ×œ× ×™×•×ª×¨ ×-8 workers ×›×“×™ ×œ× ×œ×¢××•×¡ ××ª ×”××¢×¨×›×ª
```

---

## ğŸ“Š ××¢×§×‘ ×•× ×™×˜×•×¨

### ×‘×“×™×§×ª ×¡×˜×˜×•×¡
```bash
python backend\scripts\generate_status_report.py
```

### ×œ×•×’×™×
×›×œ ×”×¤×¢×•×œ×•×ª × ×¨×©××•×ª ×¢× timestamps:
```
[10:30:15] [INFO] Starting KingStore processing...
[10:30:20] [INFO] Download completed in 5.2s
[10:35:42] [INFO] Processing completed in 322.0s
[10:37:15] [INFO] Classification completed in 93.1s
[10:37:15] [INFO] âœ… KingStore processing complete!
```

### Database Sessions
```sql
-- ××¢×§×‘ ××—×¨ ×¡×©× ×™×
SELECT * FROM scraping_sessions 
ORDER BY started_at DESC 
LIMIT 10;

-- ×§×‘×¦×™× ×©×”×•×¨×“×•
SELECT * FROM downloaded_files 
WHERE processing_status = 'completed'
ORDER BY downloaded_at DESC;
```

---

## ğŸ¯ ×ª×–××•×Ÿ ××•××œ×¥

### ×¡×•×¤×¨××¨×§×˜×™× (×¢×“×›×•×Ÿ ×ª×›×•×£)
```python
'schedule': '0 */6 * * *'  # ×›×œ 6 ×©×¢×•×ª
```

### ×¡×¤×§×™× ×¨×’×™×œ×™× (×¢×“×›×•×Ÿ ×™×•××™)
```python
'schedule': '0 8 * * *'  # ×›×œ ×‘×•×§×¨ ×‘×©×¢×” 8
```

### ××§×•×¨×•×ª ×¢× API Rate Limit
```python
'schedule': '0 */12 * * *'  # ×›×œ 12 ×©×¢×•×ª
```

---

## ğŸ”’ ××‘×˜×—×” ×•-Reliability

### 1. **Transaction Safety**
- ×›×œ batch ×‘-transaction × ×¤×¨×“
- SAVEPOINT ×œ×›×œ item
- Rollback ××•×˜×•××˜×™ ×‘×©×’×™××”

### 2. **Duplicate Prevention**
- File hash checking
- UNIQUE constraints
- ON CONFLICT handling

### 3. **Error Handling**
- Try-catch ×‘×›×œ ×¨××”
- Logging ××¤×•×¨×˜
- Graceful degradation

### 4. **Resource Management**
- Connection cleanup
- Process pools
- Memory management

---

## ğŸ“ˆ Production Checklist

### ×œ×¤× ×™ ×”×¤×¢×œ×” ×‘-Production:

- [ ] ×”×’×“×¨ ××¡×¤×¨ workers ××ª××™× ×œ××›×•× ×”
- [ ] ×•×•×“× ×©×™×© ××¡×¤×™×§ ××§×•× ×“×™×¡×§ (GB)
- [ ] ×”×’×“×¨ ×ª×–××•×Ÿ ×©×œ× ×¢×•××¡ ×‘×©×¢×•×ª ×©×™×
- [ ] ×‘×“×•×§ ×©×›×œ ×”-scripts ××¨×™×¦×™× ×œ×œ× ×©×’×™××•×ª
- [ ] ×”×¤×¢×œ backup ××•×˜×•××˜×™ ×œ-DB
- [ ] ×”×’×“×¨ monitoring (Grafana/Prometheus)
- [ ] ×‘×“×•×§ logs rotation
- [ ] ×•×•×“× ×©×”-API Server ×¨×¥ (uvicorn)

---

## ğŸ‰ ×ª×•×¦××•×ª

### Before (×™×“× ×™):
```
- ×”×•×¨×“×” ×™×“× ×™×ª ×©×œ ×§×‘×¦×™×
- ×¢×™×‘×•×“ ×™×“× ×™
- ×¡×™×•×•×’ ×™×“× ×™ ××• ×—×œ×§×™
- ×–××Ÿ: ×©×¢×•×ª ×¨×‘×•×ª â°
- ×˜×¢×•×™×•×ª ×× ×•×© âŒ
```

### After (××•×˜×•××˜×™):
```
âœ… ×”×•×¨×“×” ××•×˜×•××˜×™×ª ××›×œ ×”××§×•×¨×•×ª
âœ… ×¢×™×‘×•×“ ××§×‘×™×œ×™ ××”×™×¨
âœ… ×¡×™×•×•×’ ××•×˜×•××˜×™ 58%+
âœ… ×–××Ÿ: ×“×§×•×ª ×‘×•×“×“×•×ª âš¡
âœ… ×××™×Ÿ ×•×¢×§×‘×™ ğŸ¯
âœ… ××•×›×Ÿ ×œ-scale ğŸ“ˆ
```

---

## ğŸš€ ×”×ª×—×œ×” ××”×™×¨×”

```bash
# 1. ×”×ª×§×Ÿ dependencies
pip install schedule psycopg2

# 2. ×”×¨×¥ ×¤×¢× ××—×ª ×œ×‘×“×™×§×”
python backend\scripts\auto_price_manager.py --once

# 3. ×”×¨×¥ ×‘××¦×‘ ××•×˜×•××˜×™
python backend\scripts\auto_price_manager.py

# ××• ×“×¨×š BAT:
ğŸ¤– AUTO_PRICE_MANAGER.bat
```

---

## ğŸ’¡ Tips & Tricks

### ××”×™×¨×•×ª ××§×¡×™××œ×™×ª:
```python
--workers 8 --parallel 20
```

### ×–×”×™×¨×•×ª (××›×•× ×” ×—×œ×©×”):
```python
--workers 2 --parallel 5
```

### ×‘×“×™×§×ª ×™×›×•×œ×ª:
```bash
python -c "import multiprocessing; print(multiprocessing.cpu_count())"
```

---

## ğŸ“ ×ª××™×›×”

×× ×™×© ×‘×¢×™×”:
1. ×‘×“×•×§ ×œ×•×’×™×
2. ×”×¨×¥ `generate_status_report.py`
3. ×‘×“×•×§ ××ª `scraping_sessions` ×‘DB
4. ×‘×“×•×§ ×©××™×Ÿ processes ×ª×§×•×¢×™×

---

ğŸ¯ **×”××¢×¨×›×ª ××•×›× ×” ×œ×™×™×¦×•×¨ ×•×œ-scale!**

